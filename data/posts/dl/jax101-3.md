---
title: Jax 101-3 ğŸ¤
subtitle: Automatic Vectorization in Jax 
date: 2024-01-28 00:33:00
tags: [dl,jax]
series: 5
cover: /images/jax.jpg
---
# Automatic Vectorization in Jax ğŸš¦

> [!info] Vectorization[^1]
>
> ä½¿ç”¨ä¸€äº›æŒ‡ä»¤é›†ä¸€æ¬¡æ€§è®¡ç®—å¤šä¸ªå€¼ï¼Œè€Œä¸æ˜¯åœ¨forå¾ªç¯ä¸­é€ä¸ªéå†ã€‚


## Jax.vmap

ä½¿ä¸€ä¸ªå‡½æ•°è‡ªåŠ¨å‘é‡åŒ–

å¦‚æœbatchç»´åº¦ä¸æ˜¯0ï¼Œéœ€è¦ç”¨`in_axes`å’Œ`out_axes`æŒ‡æ˜ç»´åº¦ï¼ˆ1ï¼Œ2ï¼Œ...**None**ï¼‰

ç¤ºä¾‹ï¼š

```python
auto_batch = jax.vmap(convolve, in_axes=1, out_axes=1)
auto_batch = jax.vmap(convolve, in_axes=[1, None])
```

## å’Œjitç»„åˆ

å¯ä»¥å’Œ`jax.jit`ä»»æ„ç»„åˆ

```python
jax.jit(jax.vmap(...))
jax.vmap(jax.jit(...))
```

[^1]: https://stackoverflow.com/questions/1422149/what-is-vectorization